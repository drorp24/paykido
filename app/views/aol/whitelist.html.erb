<% title "My White List" %>

<ul id="table"></ul>

	<script type="text/javascript">
	      google.load("visualization", "1", {packages:["table"]});
		  google.setOnLoadCallback(drawTable);

		  function drawTable(){
			
		  var data = new google.visualization.DataTable();
		  	data.addColumn('string', 'Retailer');
		    data.addColumn('string', 'Product');
		    data.addColumn('string', 'Category');
		    <%= "data.addRows(#{@whitelist.size});" %>
			<% @whitelist.each do |w| -%>
		    	<%= "data.setCell(#{@i}, 0, '#{w.retailer.name}');" %>
				<%= "data.setCell(#{@i}, 1, '#{w.product.title}');" %>
				<%= "data.setCell(#{@i}, 2, '#{w.product.category.name}');" %>
				<% @i += 1 %>
			<% end %>

			var table = new google.visualization.Table(document.getElementById('table'));
			table.draw(data);			  	
		  }		

    </script>
